"use strict";function isNative(e){var t=Function.prototype.toString,n=Object.prototype.hasOwnProperty,o=RegExp("^"+t.call(n).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");try{var r=t.call(e);return o.test(r)}catch(e){return!1}}function purgeDeep(e){var t=getItem(e);if(t){var n=t.childIDs;removeItem(e);n.forEach(purgeDeep)}}function describeComponentFrame(e,t,n){return"\n    in "+(e||"Unknown")+(t?" (at "+t.fileName.replace(/^.*[\\\/]/,"")+":"+t.lineNumber+")":n?" (created by "+n+")":"")}function getDisplayName(e){return null==e?"#empty":"string"==typeof e||"number"==typeof e?"#text":"string"==typeof e.type?e.type:e.type.displayName||e.type.name||"Unknown"}function describeID(e){var t,n=ReactComponentTreeHook.getDisplayName(e),o=ReactComponentTreeHook.getElement(e),r=ReactComponentTreeHook.getOwnerID(e);r&&(t=ReactComponentTreeHook.getDisplayName(r));return describeComponentFrame(n,o&&o._source,t)}var _prodInvariant=require("./reactProdInvariant"),ReactCurrentOwner=require("./ReactCurrentOwner"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning"),canUseCollections="function"==typeof Array.from&&"function"==typeof Map&&isNative(Map)&&null!=Map.prototype&&"function"==typeof Map.prototype.keys&&isNative(Map.prototype.keys)&&"function"==typeof Set&&isNative(Set)&&null!=Set.prototype&&"function"==typeof Set.prototype.keys&&isNative(Set.prototype.keys),setItem,getItem,removeItem,getItemIDs,addRoot,removeRoot,getRootIDs;if(canUseCollections){var itemMap=new Map,rootIDSet=new Set;setItem=function(e,t){itemMap.set(e,t)};getItem=function(e){return itemMap.get(e)};removeItem=function(e){itemMap.delete(e)};getItemIDs=function(){return Array.from(itemMap.keys())};addRoot=function(e){rootIDSet.add(e)};removeRoot=function(e){rootIDSet.delete(e)};getRootIDs=function(){return Array.from(rootIDSet.keys())}}else{var itemByKey={},rootByKey={},getKeyFromID=function(e){return"."+e},getIDFromKey=function(e){return parseInt(e.substr(1),10)};setItem=function(e,t){var n=getKeyFromID(e);itemByKey[n]=t};getItem=function(e){var t=getKeyFromID(e);return itemByKey[t]};removeItem=function(e){var t=getKeyFromID(e);delete itemByKey[t]};getItemIDs=function(){return Object.keys(itemByKey).map(getIDFromKey)};addRoot=function(e){var t=getKeyFromID(e);rootByKey[t]=!0};removeRoot=function(e){var t=getKeyFromID(e);delete rootByKey[t]};getRootIDs=function(){return Object.keys(rootByKey).map(getIDFromKey)}}var unmountedIDs=[],ReactComponentTreeHook={onSetChildren:function(e,t){var n=getItem(e);n?void 0:_prodInvariant("144");n.childIDs=t;for(var o=0;o<t.length;o++){var r=t[o],a=getItem(r);a?void 0:_prodInvariant("140");null==a.childIDs&&"object"==typeof a.element&&null!=a.element?_prodInvariant("141"):void 0;a.isMounted?void 0:_prodInvariant("71");null==a.parentID&&(a.parentID=e);a.parentID!==e?_prodInvariant("142",r,a.parentID,e):void 0}},onBeforeMountComponent:function(e,t,n){var o={element:t,parentID:n,text:null,childIDs:[],isMounted:!1,updateCount:0};setItem(e,o)},onBeforeUpdateComponent:function(e,t){var n=getItem(e);n&&n.isMounted&&(n.element=t)},onMountComponent:function(e){var t=getItem(e);t?void 0:_prodInvariant("144");t.isMounted=!0;var n=0===t.parentID;n&&addRoot(e)},onUpdateComponent:function(e){var t=getItem(e);t&&t.isMounted&&t.updateCount++},onUnmountComponent:function(e){var t=getItem(e);if(t){t.isMounted=!1;var n=0===t.parentID;n&&removeRoot(e)}unmountedIDs.push(e)},purgeUnmountedComponents:function(){if(!ReactComponentTreeHook._preventPurging){for(var e=0;e<unmountedIDs.length;e++){var t=unmountedIDs[e];purgeDeep(t)}unmountedIDs.length=0}},isMounted:function(e){var t=getItem(e);return!!t&&t.isMounted},getCurrentStackAddendum:function(e){var t="";if(e){var n=getDisplayName(e),o=e._owner;t+=describeComponentFrame(n,e._source,o&&o.getName())}var r=ReactCurrentOwner.current,a=r&&r._debugID;t+=ReactComponentTreeHook.getStackAddendumByID(a);return t},getStackAddendumByID:function(e){for(var t="";e;){t+=describeID(e);e=ReactComponentTreeHook.getParentID(e)}return t},getChildIDs:function(e){var t=getItem(e);return t?t.childIDs:[]},getDisplayName:function(e){var t=ReactComponentTreeHook.getElement(e);return t?getDisplayName(t):null},getElement:function(e){var t=getItem(e);return t?t.element:null},getOwnerID:function(e){var t=ReactComponentTreeHook.getElement(e);return t&&t._owner?t._owner._debugID:null},getParentID:function(e){var t=getItem(e);return t?t.parentID:null},getSource:function(e){var t=getItem(e),n=t?t.element:null,o=null!=n?n._source:null;return o},getText:function(e){var t=ReactComponentTreeHook.getElement(e);return"string"==typeof t?t:"number"==typeof t?""+t:null},getUpdateCount:function(e){var t=getItem(e);return t?t.updateCount:0},getRootIDs:getRootIDs,getRegisteredIDs:getItemIDs};module.exports=ReactComponentTreeHook;