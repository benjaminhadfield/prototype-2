"use strict";function ensureInjected(){ReactUpdates.ReactReconcileTransaction&&batchingStrategy?void 0:_prodInvariant("123")}function ReactUpdatesFlushTransaction(){this.reinitializeTransaction();this.dirtyComponentsLength=null;this.callbackQueue=CallbackQueue.getPooled();this.reconcileTransaction=ReactUpdates.ReactReconcileTransaction.getPooled(!0)}function batchedUpdates(e,t,a,n,r,c){ensureInjected();return batchingStrategy.batchedUpdates(e,t,a,n,r,c)}function mountOrderComparator(e,t){return e._mountOrder-t._mountOrder}function runBatchedUpdates(e){var t=e.dirtyComponentsLength;t!==dirtyComponents.length?_prodInvariant("124",t,dirtyComponents.length):void 0;dirtyComponents.sort(mountOrderComparator);updateBatchNumber++;for(var a=0;a<t;a++){var n=dirtyComponents[a],r=n._pendingCallbacks;n._pendingCallbacks=null;var c;if(ReactFeatureFlags.logTopLevelRenders){var i=n;n._currentElement.type.isReactTopLevelWrapper&&(i=n._renderedComponent);c="React update: "+i.getName();console.time(c)}ReactReconciler.performUpdateIfNecessary(n,e.reconcileTransaction,updateBatchNumber);c&&console.timeEnd(c);if(r){for(var o=0;o<r.length;o++){e.callbackQueue.enqueue(r[o],n.getPublicInstance())}}}}function enqueueUpdate(e){ensureInjected();if(batchingStrategy.isBatchingUpdates){dirtyComponents.push(e);null==e._updateBatchNumber&&(e._updateBatchNumber=updateBatchNumber+1)}else{batchingStrategy.batchedUpdates(enqueueUpdate,e)}}function asap(e,t){batchingStrategy.isBatchingUpdates?void 0:_prodInvariant("125");asapCallbackQueue.enqueue(e,t);asapEnqueued=!0}var _prodInvariant=require("./reactProdInvariant"),_assign=require("object-assign"),CallbackQueue=require("./CallbackQueue"),PooledClass=require("./PooledClass"),ReactFeatureFlags=require("./ReactFeatureFlags"),ReactReconciler=require("./ReactReconciler"),Transaction=require("./Transaction"),invariant=require("fbjs/lib/invariant"),dirtyComponents=[],updateBatchNumber=0,asapCallbackQueue=CallbackQueue.getPooled(),asapEnqueued=!1,batchingStrategy=null,NESTED_UPDATES={initialize:function(){this.dirtyComponentsLength=dirtyComponents.length},close:function(){if(this.dirtyComponentsLength!==dirtyComponents.length){dirtyComponents.splice(0,this.dirtyComponentsLength);flushBatchedUpdates()}else{dirtyComponents.length=0}}},UPDATE_QUEUEING={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},TRANSACTION_WRAPPERS=[NESTED_UPDATES,UPDATE_QUEUEING];_assign(ReactUpdatesFlushTransaction.prototype,Transaction,{getTransactionWrappers:function(){return TRANSACTION_WRAPPERS},destructor:function(){this.dirtyComponentsLength=null;CallbackQueue.release(this.callbackQueue);this.callbackQueue=null;ReactUpdates.ReactReconcileTransaction.release(this.reconcileTransaction);this.reconcileTransaction=null},perform:function(e,t,a){return Transaction.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,a)}});PooledClass.addPoolingTo(ReactUpdatesFlushTransaction);var flushBatchedUpdates=function(){for(;dirtyComponents.length||asapEnqueued;){if(dirtyComponents.length){var e=ReactUpdatesFlushTransaction.getPooled();e.perform(runBatchedUpdates,null,e);ReactUpdatesFlushTransaction.release(e)}if(asapEnqueued){asapEnqueued=!1;var t=asapCallbackQueue;asapCallbackQueue=CallbackQueue.getPooled();t.notifyAll();CallbackQueue.release(t)}}},ReactUpdatesInjection={injectReconcileTransaction:function(e){e?void 0:_prodInvariant("126");ReactUpdates.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){e?void 0:_prodInvariant("127");"function"!=typeof e.batchedUpdates?_prodInvariant("128"):void 0;"boolean"!=typeof e.isBatchingUpdates?_prodInvariant("129"):void 0;batchingStrategy=e}},ReactUpdates={ReactReconcileTransaction:null,batchedUpdates:batchedUpdates,enqueueUpdate:enqueueUpdate,flushBatchedUpdates:flushBatchedUpdates,injection:ReactUpdatesInjection,asap:asap};module.exports=ReactUpdates;