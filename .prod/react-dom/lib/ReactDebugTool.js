"use strict";function callHook(e,n,t,r,o,i,u,a){try{n.call(t,r,o,i,u,a)}catch(n){didHookThrowForEvent[e]=!0}}function emitEvent(e,n,t,r,o,i){for(var u=0;u<hooks.length;u++){var a=hooks[u],c=a[e];c&&callHook(e,c,a,n,t,r,o,i)}}function clearHistory(){ReactComponentTreeHook.purgeUnmountedComponents();ReactHostOperationHistoryHook.clearHistory()}function getTreeSnapshot(e){return e.reduce(function(e,n){var t=ReactComponentTreeHook.getOwnerID(n),r=ReactComponentTreeHook.getParentID(n);e[n]={displayName:ReactComponentTreeHook.getDisplayName(n),text:ReactComponentTreeHook.getText(n),updateCount:ReactComponentTreeHook.getUpdateCount(n),childIDs:ReactComponentTreeHook.getChildIDs(n),ownerID:t||r&&ReactComponentTreeHook.getOwnerID(r)||0,parentID:r};return e},{})}function resetMeasurements(){var e=currentFlushStartTime,n=currentFlushMeasurements,t=ReactHostOperationHistoryHook.getHistory();if(0!==currentFlushNesting){if(n.length||t.length){var r=ReactComponentTreeHook.getRegisteredIDs();flushHistory.push({duration:performanceNow()-e,measurements:n||[],operations:t||[],treeSnapshot:getTreeSnapshot(r)})}clearHistory();currentFlushStartTime=performanceNow();currentFlushMeasurements=[]}else{currentFlushStartTime=0;currentFlushMeasurements=[];clearHistory()}}function checkDebugID(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1]}function beginLifeCycleTimer(e,n){if(0!==currentFlushNesting){currentTimerType&&!lifeCycleTimerHasWarned&&(lifeCycleTimerHasWarned=!0);currentTimerStartTime=performanceNow();currentTimerNestedFlushDuration=0;currentTimerDebugID=e;currentTimerType=n}}function endLifeCycleTimer(e,n){if(0!==currentFlushNesting){currentTimerType===n||lifeCycleTimerHasWarned||(lifeCycleTimerHasWarned=!0);isProfiling&&currentFlushMeasurements.push({timerType:n,instanceID:e,duration:performanceNow()-currentTimerStartTime-currentTimerNestedFlushDuration});currentTimerStartTime=0;currentTimerNestedFlushDuration=0;currentTimerDebugID=null;currentTimerType=null}}function pauseCurrentLifeCycleTimer(){var e={startTime:currentTimerStartTime,nestedFlushStartTime:performanceNow(),debugID:currentTimerDebugID,timerType:currentTimerType};lifeCycleTimerStack.push(e);currentTimerStartTime=0;currentTimerNestedFlushDuration=0;currentTimerDebugID=null;currentTimerType=null}function resumeCurrentLifeCycleTimer(){var e=lifeCycleTimerStack.pop(),n=e.startTime,t=e.nestedFlushStartTime,r=e.debugID,o=e.timerType,i=performanceNow()-t;currentTimerStartTime=n;currentTimerNestedFlushDuration+=i;currentTimerDebugID=r;currentTimerType=o}function shouldMark(e){if(!isProfiling||!canUsePerformanceMeasure){return!1}var n=ReactComponentTreeHook.getElement(e);if(null==n||"object"!=typeof n){return!1}var t="string"==typeof n.type;return!t}function markBegin(e,n){if(shouldMark(e)){var t=e+"::"+n;lastMarkTimeStamp=performanceNow();performance.mark(t)}}function markEnd(e,n){if(shouldMark(e)){var t=e+"::"+n,r=ReactComponentTreeHook.getDisplayName(e)||"Unknown",o=performanceNow();if(o-lastMarkTimeStamp>.1){var i=r+" ["+n+"]";performance.measure(i,t)}performance.clearMarks(t);performance.clearMeasures(i)}}var ReactInvalidSetStateWarningHook=require("./ReactInvalidSetStateWarningHook"),ReactHostOperationHistoryHook=require("./ReactHostOperationHistoryHook"),ReactComponentTreeHook=require("react/lib/ReactComponentTreeHook"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),performanceNow=require("fbjs/lib/performanceNow"),warning=require("fbjs/lib/warning"),hooks=[],didHookThrowForEvent={},isProfiling=!1,flushHistory=[],lifeCycleTimerStack=[],currentFlushNesting=0,currentFlushMeasurements=[],currentFlushStartTime=0,currentTimerDebugID=null,currentTimerStartTime=0,currentTimerNestedFlushDuration=0,currentTimerType=null,lifeCycleTimerHasWarned=!1,lastMarkTimeStamp=0,canUsePerformanceMeasure="undefined"!=typeof performance&&"function"==typeof performance.mark&&"function"==typeof performance.clearMarks&&"function"==typeof performance.measure&&"function"==typeof performance.clearMeasures,ReactDebugTool={addHook:function(e){hooks.push(e)},removeHook:function(e){for(var n=0;n<hooks.length;n++){if(hooks[n]===e){hooks.splice(n,1);n--}}},isProfiling:function(){return isProfiling},beginProfiling:function(){if(!isProfiling){isProfiling=!0;flushHistory.length=0;resetMeasurements();ReactDebugTool.addHook(ReactHostOperationHistoryHook)}},endProfiling:function(){if(isProfiling){isProfiling=!1;resetMeasurements();ReactDebugTool.removeHook(ReactHostOperationHistoryHook)}},getFlushHistory:function(){return flushHistory},onBeginFlush:function(){currentFlushNesting++;resetMeasurements();pauseCurrentLifeCycleTimer();emitEvent("onBeginFlush")},onEndFlush:function(){resetMeasurements();currentFlushNesting--;resumeCurrentLifeCycleTimer();emitEvent("onEndFlush")},onBeginLifeCycleTimer:function(e,n){checkDebugID(e);emitEvent("onBeginLifeCycleTimer",e,n);markBegin(e,n);beginLifeCycleTimer(e,n)},onEndLifeCycleTimer:function(e,n){checkDebugID(e);endLifeCycleTimer(e,n);markEnd(e,n);emitEvent("onEndLifeCycleTimer",e,n)},onBeginProcessingChildContext:function(){emitEvent("onBeginProcessingChildContext")},onEndProcessingChildContext:function(){emitEvent("onEndProcessingChildContext")},onHostOperation:function(e){checkDebugID(e.instanceID);emitEvent("onHostOperation",e)},onSetState:function(){emitEvent("onSetState")},onSetChildren:function(e,n){checkDebugID(e);n.forEach(checkDebugID);emitEvent("onSetChildren",e,n)},onBeforeMountComponent:function(e,n,t){checkDebugID(e);checkDebugID(t,!0);emitEvent("onBeforeMountComponent",e,n,t);markBegin(e,"mount")},onMountComponent:function(e){checkDebugID(e);markEnd(e,"mount");emitEvent("onMountComponent",e)},onBeforeUpdateComponent:function(e,n){checkDebugID(e);emitEvent("onBeforeUpdateComponent",e,n);markBegin(e,"update")},onUpdateComponent:function(e){checkDebugID(e);markEnd(e,"update");emitEvent("onUpdateComponent",e)},onBeforeUnmountComponent:function(e){checkDebugID(e);emitEvent("onBeforeUnmountComponent",e);markBegin(e,"unmount")},onUnmountComponent:function(e){checkDebugID(e);markEnd(e,"unmount");emitEvent("onUnmountComponent",e)},onTestEvent:function(){emitEvent("onTestEvent")}};ReactDebugTool.addDevtool=ReactDebugTool.addHook;ReactDebugTool.removeDevtool=ReactDebugTool.removeHook;ReactDebugTool.addHook(ReactInvalidSetStateWarningHook);ReactDebugTool.addHook(ReactComponentTreeHook);var url=ExecutionEnvironment.canUseDOM&&window.location.href||"";/[?&]react_perf\b/.test(url)&&ReactDebugTool.beginProfiling();module.exports=ReactDebugTool;