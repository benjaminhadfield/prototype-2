"use strict";function findParent(e){for(;e._hostParent;){e=e._hostParent}var n=ReactDOMComponentTree.getNodeFromInstance(e),t=n.parentNode;return ReactDOMComponentTree.getClosestInstanceFromNode(t)}function TopLevelCallbackBookKeeping(e,n){this.topLevelType=e;this.nativeEvent=n;this.ancestors=[]}function handleTopLevelImpl(e){var n=getEventTarget(e.nativeEvent),t=ReactDOMComponentTree.getClosestInstanceFromNode(n),o=t;do{e.ancestors.push(o);o=o&&findParent(o)}while(o);for(var l=0;l<e.ancestors.length;l++){t=e.ancestors[l];ReactEventListener._handleTopLevel(e.topLevelType,t,e.nativeEvent,getEventTarget(e.nativeEvent))}}function scrollValueMonitor(e){var n=getUnboundedScrollPosition(window);e(n)}var _assign=require("object-assign"),EventListener=require("fbjs/lib/EventListener"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),PooledClass=require("./PooledClass"),ReactDOMComponentTree=require("./ReactDOMComponentTree"),ReactUpdates=require("./ReactUpdates"),getEventTarget=require("./getEventTarget"),getUnboundedScrollPosition=require("fbjs/lib/getUnboundedScrollPosition");_assign(TopLevelCallbackBookKeeping.prototype,{destructor:function(){this.topLevelType=null;this.nativeEvent=null;this.ancestors.length=0}});PooledClass.addPoolingTo(TopLevelCallbackBookKeeping,PooledClass.twoArgumentPooler);var ReactEventListener={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:ExecutionEnvironment.canUseDOM?window:null,setHandleTopLevel:function(e){ReactEventListener._handleTopLevel=e},setEnabled:function(e){ReactEventListener._enabled=!!e},isEnabled:function(){return ReactEventListener._enabled},trapBubbledEvent:function(e,n,t){return t?EventListener.listen(t,n,ReactEventListener.dispatchEvent.bind(null,e)):null},trapCapturedEvent:function(e,n,t){return t?EventListener.capture(t,n,ReactEventListener.dispatchEvent.bind(null,e)):null},monitorScrollValue:function(e){var n=scrollValueMonitor.bind(null,e);EventListener.listen(window,"scroll",n)},dispatchEvent:function(e,n){if(ReactEventListener._enabled){var t=TopLevelCallbackBookKeeping.getPooled(e,n);try{ReactUpdates.batchedUpdates(handleTopLevelImpl,t)}finally{TopLevelCallbackBookKeeping.release(t)}}}};module.exports=ReactEventListener;