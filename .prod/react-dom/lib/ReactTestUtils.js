"use strict";function Event(e){}function findAllInRenderedTreeInternal(e,t){if(!e||!e.getPublicInstance){return[]}var n=e.getPublicInstance(),i=t(n)?[n]:[],r=e._currentElement;if(ReactTestUtils.isDOMComponent(n)){var o,a=e._renderedChildren;for(o in a){a.hasOwnProperty(o)&&(i=i.concat(findAllInRenderedTreeInternal(a[o],t)))}}else{React.isValidElement(r)&&"function"==typeof r.type&&(i=i.concat(findAllInRenderedTreeInternal(e._renderedComponent,t)))}return i}function makeSimulator(e){return function(t,n){var i;React.isValidElement(t)?_prodInvariant("14"):void 0;ReactTestUtils.isDOMComponent(t)?i=findDOMNode(t):t.tagName&&(i=t);var r=EventPluginRegistry.eventNameDispatchConfigs[e],o=new Event;o.target=i;o.type=e.toLowerCase();var a=new SyntheticEvent(r,ReactDOMComponentTree.getInstanceFromNode(i),o,i);a.persist();_assign(a,n);r.phasedRegistrationNames?EventPropagators.accumulateTwoPhaseDispatches(a):EventPropagators.accumulateDirectDispatches(a);ReactUpdates.batchedUpdates(function(){EventPluginHub.enqueueEvents(a);EventPluginHub.processEventQueue(!0)})}}function buildSimulators(){ReactTestUtils.Simulate={};var e;for(e in EventPluginRegistry.eventNameDispatchConfigs){ReactTestUtils.Simulate[e]=makeSimulator(e)}}function makeNativeSimulator(e){return function(t,n){var i=new Event(e);_assign(i,n);ReactTestUtils.isDOMComponent(t)?ReactTestUtils.simulateNativeEventOnDOMComponent(e,t,i):t.tagName&&ReactTestUtils.simulateNativeEventOnNode(e,t,i)}}var _prodInvariant=require("./reactProdInvariant"),_assign=require("object-assign"),EventConstants=require("./EventConstants"),EventPluginHub=require("./EventPluginHub"),EventPluginRegistry=require("./EventPluginRegistry"),EventPropagators=require("./EventPropagators"),React=require("react/lib/React"),ReactDOM=require("./ReactDOM"),ReactDOMComponentTree=require("./ReactDOMComponentTree"),ReactBrowserEventEmitter=require("./ReactBrowserEventEmitter"),ReactInstanceMap=require("./ReactInstanceMap"),ReactUpdates=require("./ReactUpdates"),SyntheticEvent=require("./SyntheticEvent"),ReactShallowRenderer=require("./ReactShallowRenderer"),findDOMNode=require("./findDOMNode"),invariant=require("fbjs/lib/invariant"),topLevelTypes=EventConstants.topLevelTypes,ReactTestUtils={renderIntoDocument:function(e){var t=document.createElement("div");return ReactDOM.render(e,t)},isElement:function(e){return React.isValidElement(e)},isElementOfType:function(e,t){return React.isValidElement(e)&&e.type===t},isDOMComponent:function(e){return!(!e||1!==e.nodeType||!e.tagName)},isDOMComponentElement:function(e){return!!(e&&React.isValidElement(e)&&e.tagName)},isCompositeComponent:function(e){return!ReactTestUtils.isDOMComponent(e)&&(null!=e&&"function"==typeof e.render&&"function"==typeof e.setState)},isCompositeComponentWithType:function(e,t){if(!ReactTestUtils.isCompositeComponent(e)){return!1}var n=ReactInstanceMap.get(e),i=n._currentElement.type;return i===t},isCompositeComponentElement:function(e){if(!React.isValidElement(e)){return!1}var t=e.type.prototype;return"function"==typeof t.render&&"function"==typeof t.setState},isCompositeComponentElementWithType:function(e,t){var n=ReactInstanceMap.get(e),i=n._currentElement.type;return!(!ReactTestUtils.isCompositeComponentElement(e)||i!==t)},getRenderedChildOfCompositeComponent:function(e){if(!ReactTestUtils.isCompositeComponent(e)){return null}var t=ReactInstanceMap.get(e);return t._renderedComponent.getPublicInstance()},findAllInRenderedTree:function(e,t){if(!e){return[]}ReactTestUtils.isCompositeComponent(e)?void 0:_prodInvariant("10");return findAllInRenderedTreeInternal(ReactInstanceMap.get(e),t)},scryRenderedDOMComponentsWithClass:function(e,t){return ReactTestUtils.findAllInRenderedTree(e,function(e){if(ReactTestUtils.isDOMComponent(e)){var n=e.className;"string"!=typeof n&&(n=e.getAttribute("class")||"");var i=n.split(/\s+/);if(!Array.isArray(t)){void 0===t?_prodInvariant("11"):void 0;t=t.split(/\s+/)}return t.every(function(e){return i.indexOf(e)!==-1})}return!1})},findRenderedDOMComponentWithClass:function(e,t){var n=ReactTestUtils.scryRenderedDOMComponentsWithClass(e,t);if(1!==n.length){throw new Error("Did not find exactly one match (found: "+n.length+") for class:"+t)}return n[0]},scryRenderedDOMComponentsWithTag:function(e,t){return ReactTestUtils.findAllInRenderedTree(e,function(e){return ReactTestUtils.isDOMComponent(e)&&e.tagName.toUpperCase()===t.toUpperCase()})},findRenderedDOMComponentWithTag:function(e,t){var n=ReactTestUtils.scryRenderedDOMComponentsWithTag(e,t);if(1!==n.length){throw new Error("Did not find exactly one match (found: "+n.length+") for tag:"+t)}return n[0]},scryRenderedComponentsWithType:function(e,t){return ReactTestUtils.findAllInRenderedTree(e,function(e){return ReactTestUtils.isCompositeComponentWithType(e,t)})},findRenderedComponentWithType:function(e,t){var n=ReactTestUtils.scryRenderedComponentsWithType(e,t);if(1!==n.length){throw new Error("Did not find exactly one match (found: "+n.length+") for componentType:"+t)}return n[0]},mockComponent:function(e,t){t=t||e.mockTagName||"div";e.prototype.render.mockImplementation(function(){return React.createElement(t,null,this.props.children)});return this},simulateNativeEventOnNode:function(e,t,n){n.target=t;ReactBrowserEventEmitter.ReactEventListener.dispatchEvent(e,n)},simulateNativeEventOnDOMComponent:function(e,t,n){ReactTestUtils.simulateNativeEventOnNode(e,findDOMNode(t),n)},nativeTouchData:function(e,t){return{touches:[{pageX:e,pageY:t}]}},createRenderer:function(){return new ReactShallowRenderer},Simulate:null,SimulateNative:{}},oldInjectEventPluginOrder=EventPluginHub.injection.injectEventPluginOrder;EventPluginHub.injection.injectEventPluginOrder=function(){oldInjectEventPluginOrder.apply(this,arguments);buildSimulators()};var oldInjectEventPlugins=EventPluginHub.injection.injectEventPluginsByName;EventPluginHub.injection.injectEventPluginsByName=function(){oldInjectEventPlugins.apply(this,arguments);buildSimulators()};buildSimulators();Object.keys(topLevelTypes).forEach(function(e){var t=0===e.indexOf("top")?e.charAt(3).toLowerCase()+e.substr(4):e;ReactTestUtils.SimulateNative[t]=makeNativeSimulator(e)});module.exports=ReactTestUtils;